<!doctype html>
<html><head><meta charset="utf-8"/><title>Arena</title><meta name="viewport" content="width=device-width,initial-scale=1" /><link rel="stylesheet" href="../../style.css" />
<style>canvas{display:block;margin:18px auto;border-radius:10px;background:#071127}</style></head><body>
<header class="header"><div class="brand"><h1>Arena â€” 2P</h1><p class="sub">WASD+F vs Arrows+L</p></div><div class="hdr-actions"><button class="btn ghost" onclick="location.href='../../index.html'">Back</button></div></header>
<canvas id="c" width="900" height="520"></canvas>
<script>
const canvas=document.getElementById('c'), ctx=canvas.getContext('2d');
const w=canvas.width,h=canvas.height;
function rand(min,max){return Math.random()*(max-min)+min}
function makePlayer(x,y,color,keys,shootKey){return {x,y,w:28,h:28,dx:0,dy:0,color,bulletCooldown:0,health:100,keys,shootKey,bullets:[]};}
const p1 = makePlayer(120, h/2, '#06b6d4', {up:'w',down:'s', left:'a', right:'d'}, 'f');
const p2 = makePlayer(w-150, h/2, '#f43f5e', {up:'ArrowUp',down:'ArrowDown', left:'ArrowLeft', right:'ArrowRight'}, 'l');
const keysDown = {};
document.addEventListener('keydown', e=>{ keysDown[e.key]=true; });
document.addEventListener('keyup', e=>{ delete keysDown[e.key]; });
function updatePlayer(p){
  const speed = 3.6;
  p.dx = (keysDown[p.keys.right]?1:0) - (keysDown[p.keys.left]?1:0);
  p.dy = (keysDown[p.keys.down]?1:0) - (keysDown[p.keys.up]?1:0);
  p.x += p.dx*speed; p.y += p.dy*speed;
  p.x = Math.max(10, Math.min(w - p.w -10, p.x));
  p.y = Math.max(10, Math.min(h - p.h -10, p.y));
  if(p.bulletCooldown>0) p.bulletCooldown--;
  if(keysDown[p.shootKey] && p.bulletCooldown<=0){ shoot(p); p.bulletCooldown=18; }
  p.bullets.forEach(b=>{ b.x += b.vx; b.y += b.vy; });
  p.bullets = p.bullets.filter(b=> b.x>0 && b.x<w && b.y>0 && b.y<h && !b.dead);
}
function shoot(p){
  let targetX = (p===p1 ? p2.x + p2.w/2 : p1.x + p1.w/2);
  let targetY = (p===p1 ? p2.y + p2.h/2 : p1.y + p1.h/2);
  const angle = Math.atan2(targetY - (p.y+p.h/2), targetX - (p.x+p.w/2));
  const speed = 7;
  p.bullets.push({x: p.x + p.w/2, y: p.y + p.h/2, vx: Math.cos(angle)*speed, vy: Math.sin(angle)*speed, r:5, owner:p});
}
function rectHits(a,b){ return a.x < b.x+b.w && a.x+a.w > b.x && a.y < b.y+b.h && a.y+a.h > b.y; }
let particles = [];
function spawnParticles(x,y,color,count=8){ for(let i=0;i<count;i++){ particles.push({x,y,vx:rand(-3,3),vy:rand(-3,3),life:30,color}); } }
function update(){
  updatePlayer(p1); updatePlayer(p2);
  [p1,p2].forEach(p=>{
    p.bullets.forEach(b=>{
      const target = (b.owner===p1)?p2:p1;
      if(rectHits({x:b.x-b.r,y:b.y-b.r,w:b.r*2,h:b.r*2}, target)){
        b.dead=true; target.health -= 12; spawnParticles(b.x,b.y,'orange',10);
      }
    });
  });
  particles.forEach(pt=>{ pt.x+=pt.vx; pt.y+=pt.vy; pt.vy+=0.12; pt.life--; });
  particles = particles.filter(p=>p.life>0);
  if(p1.health<=0 || p2.health<=0){ showWin(p1.health>p2.health? 'Player 1 wins!':'Player 2 wins!'); resetGame(); }
}
let lastWin = null;
function showWin(t){ lastWin = {text:t, ttl:200}; }
function resetGame(){ p1.x=120; p1.y=h/2; p1.health=100; p1.bullets=[]; p2.x=w-150; p2.y=h/2; p2.health=100; p2.bullets=[]; }
function draw(){
  ctx.clearRect(0,0,w,h);
  ctx.fillStyle='#071127'; ctx.fillRect(0,0,w,h);
  ctx.strokeStyle='rgba(255,255,255,0.03)'; ctx.beginPath(); ctx.moveTo(w/2,0); ctx.lineTo(w/2,h); ctx.stroke();
  [p1,p2].forEach(p=>{
    ctx.fillStyle=p.color; ctx.fillRect(p.x,p.y,p.w,p.h);
    ctx.fillStyle='rgba(0,0,0,0.4)'; ctx.fillRect(p.x, p.y - 10, p.w, 6);
    ctx.fillStyle='#0f0'; ctx.fillRect(p.x, p.y - 10, p.w*(p.health/100), 6);
  });
  [p1,p2].forEach(p=>p.bullets.forEach(b=>{ ctx.fillStyle='#fff'; ctx.beginPath(); ctx.arc(b.x,b.y,b.r,0,Math.PI*2); ctx.fill(); }));
  particles.forEach(pt=>{ ctx.fillStyle=pt.color; ctx.globalAlpha = Math.max(0, pt.life/30); ctx.fillRect(pt.x,pt.y,3,3); ctx.globalAlpha=1; });
  ctx.fillStyle='#cfeffd'; ctx.font='16px Inter'; ctx.fillText(`P1 ${p1.health}`, 18, 22); ctx.fillText(`P2 ${p2.health}`, w-80,22);
  if(lastWin){ ctx.fillStyle='rgba(0,0,0,0.6)'; ctx.fillRect(w/2-150,h/2-30,300,60); ctx.fillStyle='#fff'; ctx.textAlign='center'; ctx.font='20px Inter'; ctx.fillText(lastWin.text,w/2,h/2+7); lastWin.ttl--; if(lastWin.ttl<=0) lastWin=null; ctx.textAlign='start'; }
}
function loop(){ update(); draw(); requestAnimationFrame(loop); }
loop();
</script></body></html>
